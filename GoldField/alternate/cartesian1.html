<html>
  <head>
    <style>
    </style>
    <script src="goldfield.js"></script>
    <script src="cartesian.js"></script>
    <script>
      var goldField;
      var halfX = 10
      var hero = null;

      function init()
      {
        goldField = new GoldField(document.getElementById("field"),30, 2*halfX+1, 1);
        goldField.SetKeyListener(Key);
        xAxis = new XAxis()
        goldField.AddGenericLayer(xAxis);
        xAxis.SetLayerOn(true);
        goldField.Redraw();

        hero = goldField.AddHero();
        hero.SetPosition(10,0);
        document.getElementById("output").innerHTML = "Hero at : 0";
      }

      function Key(event)
      {
        //37 left arrow
        //38 up arrow
        //39 right arrow
        //40 down arrow

        var deltaX = 0;
        var deltaY = 0;
        if(event[0]==37)
        {
          deltaX = -1;
        }
        else if(event[0]==38)
        {
          deltaY = -1;
        }
        else if(event[0]==39)
        {
          deltaX = 1;
        }
        else if(event[0]==40)
        {
          deltaY = 1;
        }

        if(hero != null)
        {
           var dim = field.GetDimensions();
           var loc = hero.GetPosition();
           if(!(loc[0] + deltaX < 0 || loc[0] + deltaX == dim[0]))
           {
             loc[0] = loc[0]+deltaX;
           }

           if(!(loc[1] + deltaY < 0 || loc[1] + deltaY == dim[1]))
           {
             loc[1] = loc[1]+deltaY;
           }

           var nextSpace = field.LookAt(loc[0],loc[1]);
           if(nextSpace[0]==Empty)
           {
             document.getElementById("output").innerHTML = "Hero at : "+(loc[0]-halfX);
             hero.SetPosition(loc[0],loc[1]);
           }
        }
      }
    </script>
  </head>
  <body onload="init()">
    <canvas id="field"></canvas>
    <p id="output"></p>
  </body>
</html>
