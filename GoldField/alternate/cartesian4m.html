<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <style>
      .yellow {color:yellow; font-weight:bold;}
      .red {color:red; font-weight:bold;}
      .blue {color:blue; font-weight:bold;}
    </style>
    <script src="ttip.js"></script>
    <script src="goldfield.js"></script>
    <script src="cartesian.js"></script>
    <script src="vectors.js"></script>
    <script>
      var goldField;
      var half = 10;
      var xCurr=0;
      var yCurr=0;
      var distance=0;
      var gold=0;
      
      function init()
      {
        blockWin = false;
        document.getElementById("nextLink").style.visibility="hidden"
        goldField = new GoldField(document.getElementById("field"),30, 2*half+1, 2*half+1);
        goldField.SetKeyListener(Key);

        yAxis = new YAxis()
        goldField.AddGenericLayer(yAxis);
        yAxis.SetLayerOn(true);

        xAxis = new XAxis()
        goldField.AddGenericLayer(xAxis);
        xAxis.SetLayerOn(true);

        grid = new Grid()
        goldField.AddGenericLayer(grid);
        grid.SetLayerOn(true);
        
        var origin = half;
        xComp = new Vector(origin,origin,4,0,"#FF0000")
        goldField.AddGenericLayer(xComp);
        xComp.SetLayerOn(true);

        yComp = new Vector(origin+4,origin,0,-3,"#0000FF")
        goldField.AddGenericLayer(yComp);
        yComp.SetLayerOn(true);

        vect = new Vector(origin,origin,4,-3,"#FFFF00")
        goldField.AddGenericLayer(vect);
        vect.SetLayerOn(true);

        hero = goldField.AddHero();
        monster = goldField.AddMonster();
        monster.SetPosition(origin,origin);
        ResetBoard();
      }
     
      function ResetBoard()
      {
        document.getElementById("reset").style.visibility="hidden";
        xCurr = Math.floor(Math.random()*(2*half+1));
        yCurr = Math.floor(Math.random()*(2*half+1));
        targetX = Math.floor(Math.random()*(2*half+1));
        targetY = Math.floor(Math.random()*(2*half+1));
        while(xCurr==targetX && yCurr==targetY)
        {
          targetX = Math.floor(Math.random()*(2*half+1));
          targetY = Math.floor(Math.random()*(2*half+1));
          distance = Math.sqrt(((targetX-xCurr)*(targetX-xCurr))+((targetY-yCurr)*(targetY-yCurr)));
        }
        
        hero.SetPosition(xCurr,yCurr);
        xComp.xHat=xCurr-xComp.xStart;
        yComp.xStart=xCurr;
        yComp.yHat=yCurr-yComp.yStart
        vect.xHat=xCurr-vect.xStart;
        vect.yHat=yCurr-vect.yStart;
        goldField.Redraw();

        xCurr-=half;
        yCurr=half-yCurr;

        document.getElementById("xPos").value=""+xCurr;
        document.getElementById("yPos").value=""+yCurr;
      }

      function Key(event)
      {
        //37 left arrow
        //38 up arrow
        //39 right arrow
        //40 down arrow

        var deltaX = 0;
        var deltaY = 0;
        if(event[0]==37)
        {
          deltaX = -1;
        }
        else if(event[0]==38)
        {
          deltaY = -1;
        }
        else if(event[0]==39)
        {
          deltaX = 1;
        }
        else if(event[0]==40)
        {
          deltaY = 1;
        }

        if(hero != null)
        {
           var dim = field.GetDimensions();
           var loc = hero.GetPosition();
           if(!(loc[0] + deltaX < 0 || loc[0] + deltaX == dim[0]))
           {
             loc[0] = loc[0]+deltaX;
           }

           if(!(loc[1] + deltaY < 0 || loc[1] + deltaY == dim[1]))
           {
             loc[1] = loc[1]+deltaY;
           }

           var nextSpace = field.LookAt(loc[0],loc[1]);
          
           if(nextSpace[0]==Empty)
           {
             hero.SetPosition(loc[0],loc[1]);
             xCurr=loc[0];
             yCurr=loc[1];
             xComp.xHat=xCurr-xComp.xStart;
             yComp.xStart=xCurr;
             yComp.yHat=yCurr-yComp.yStart
             vect.xHat=xCurr-vect.xStart;
             vect.yHat=yCurr-vect.yStart;
             goldField.Redraw();
           }
        }        
      }
    </script>
  </head>
  <body onload="init()">
    <table><tr><td>
      <canvas id="field"></canvas></td>
      <td class="top">
        <p class="content">
          Let's introduce another programming concept called the <span class="ttip" id="vector" onmouseover="showTTip(this.id)" onmouseout="hideTTip()">vector</span>. A vector can be represented on screen as
          an arrow. As the character moves around the screen the <span class="yellow">YELLOW</span> vector shows the direction and distance from the monster to the hero. That vector has two <span class="ttip" id="components" onmouseover="showTTip(this.id)" onmouseout="hideTTip()">components</span>
          for <span class="red">X DISTANCE</span> and <span class="blue">Y DISTANCE</span> that you have already seen. While we can't directly measure the yellow vector, we can use the components to make 
          decisions about the game. Which way to the hero? Is he close enough for the monster to see him?
        </p>
        <p class="content">
          The first thing we want to know about the vector is the <span class="ttip" id="slop" onmouseover="showTTip(this.id)" onmouseout="hideTTip()">slope</span>. Just like the name indicates, we want to
          know how much that yellow line slops up or down screen. It's just a great tool for knowing more about where that hero is located. The slope is easy to use because it only needs the same distance
          we already know how to get.
        <p class="code">
          <br>
          <span class="red">X Distance<input type="text" id="xPos" maxlength="2" size="2" onchange="newLocation()"></input>,<input type="text" id="yPos" maxlength="2" size="2" onchange="newLocation()"></input>) 
          <br>&nbsp;
        </p>
        <h2>Can You Find the Gold?</h2>
        <p class="content">
          There is a hidden gold bar in the field. Change the xPos and yPos above to search the space. You can also use the arrows.
          I'll let you know if you are further or nearer until you find it. 
        </p>
        <p id="output"></p>
        <a href="cartesian3a.html" id="nextLink"><img src="nextbutton.png"></a><br>
        <button id="reset" onclick='ResetBoard()'>Try again</button><br>
      </td></tr>
    </table>
    <div id="tooltip">
    </div>
  </body>
</html>
